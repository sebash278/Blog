<%- include("partials/header.ejs") %>

  <div class="hero">
    <h1 class="typing-title">
      <span class="typing-text" data-text="Bienvenido al Blogsini"></span>
      <span class="typing-cursor">|</span>
    </h1>
    <p class="hero-subtitle">Escribe lo que quieras :)</p>
    <a href="#posts-section" class="hero-cta">
            <span>Descubre los últimos posts</span>
            <svg class="hero-cta-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="m6 9 6 6 6-6"/>
            </svg>
    </a>
  </div>

<div class="container">
  <div class="posts-container" id="posts-section">
    <% if (posts.length > 0) { %> <% posts.forEach(post => { %>
    <article class="post-card">
      <div class="post-image">
        <img src="https://picsum.photos/400/200?random=<%= post.id %>" alt="<%= post.title %>">
      </div>
      <div class="post-header">
        <a href="/post/<%= post.id %>"
          ><h2 class="post-title"><%= post.title %></h2></a
        >
        <div class="post-meta">
          <span class="author"> <%= post.author %> </span>
          <span class="separator">•</span>
          <span class="date"> <%= post.date %> </span>
        </div>
      </div>
      <div class="post-content">
        <p><%= post.content.substring(0, 150) %>...</p>
        <a href="/post/<%= post.id %>" class="read-more">Leer más</a>
      </div>
      <div class="post-actions">
        <% if (user) { %>
          <button 
            class="like-btn <%= post.likedBy && user && post.likedBy.includes(user.id) ? 'liked' : '' %>" 
            onclick="toggleLike(this)" 
            data-post-id="<%= post.id %>">
            
            <svg class="heart" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
            </svg>
            
            <span class="like-count"><%= post.likes || 0 %></span>
          </button>
        <% } else { %>
          <div class="like-display">
            <svg class="heart" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
            </svg>
            <span><%= post.likes || 0 %></span>
          </div>
        <% } %>
      </div>
    </article>
    <% }); %> <% } else { %>
    <div class="no-posts">
      <h3>No hay posts aún</h3>
      <p>¡Sé el primero en crear uno!</p>
      <a href="/create" class="btn btn-primary">Crear mi primer post</a>
    </div>
    <% } %>
  </div>
</div>

<script src="/js/main.js" defer></script>

<%- include("partials/footer.ejs") %>
